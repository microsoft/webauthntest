/* Spacing & layout for Update Transports dialog action buttons */
.transport-actions {
  margin-top: 12px;
  padding-top: 14px; /* spacing above buttons */
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: center;
  border-top: 2px solid rgba(63,81,181,0.45);
}

/* Update Transports: add a horizontal divider between the two bottom button rows
   (between Clear/Select All row and Cancel/Save row). */
#updateTransportsDialog .transport-actions {
  margin-bottom: 14px;
  padding-bottom: 14px;
  border-bottom: 2px solid rgba(63,81,181,0.45);
}

/* Update Transports: center bottom Cancel/Save row */
#updateTransportsDialog > .app-dialog-actions {
  justify-content: center;
}

/* Update Credential Transports: keep checkbox labels left-aligned like Create/Get */
#updateTransportsDialog .app-dialog-content label.label {
  justify-content: flex-start;
  gap: 10px;
}

#updateTransportsDialog .app-dialog-content label.label .label-text {
  margin-left: 0;
  font-size: inherit;
  font-weight: inherit;
  line-height: inherit;
}

/* Update Credential Transports: Clear/Select All should not look outlined */
#updateTransportsDialog_clearButton,
#updateTransportsDialog_selectAllButton {
  border: 0 !important;
  box-shadow: none !important;
  background: transparent !important;
}
/*
  NOTE: Several elements inside credential cards use a .mono class with
  100% width. Historically the padding+border caused visual overflow where
  the rounded mono boxes extended slightly beyond their lighter grey
  container (.reg-data). To fix that, .mono uses box-sizing: border-box and
  max-width:100% so padding and border are included in the width calculation
  and inner boxes don't escape their parent boundaries.
*/



html, body {
  font-family: 'Roboto', 'Helvetica', sans-serif;
  margin: 0;
  padding: 0;
}

html {
  background-color: rgb(var(--fallback-b2, 245 245 245)) !important;
  background-color: oklch(var(--b2)) !important;
}

/* Ensure the page background stays consistent (matches DaisyUI base-200).
   Use a safe fallback for browsers that don't support oklch(). */
body {
  background-color: rgb(var(--fallback-b2, 245 245 245)) !important;
  background-color: oklch(var(--b2)) !important;
}

main {
  background-color: rgb(var(--fallback-b2, 245 245 245)) !important;
  background-color: oklch(var(--b2)) !important;
}

:root {
  /* configurable max-height for mono blocks inside dialogs/cards; viewport-relative by default */
  --mono-max-height: 60vh;

  /* Old-UI action color */
  --action-blue: #1a73e8;

  /* Global button hover treatment */
  --btn-hover-outline: rgba(26, 115, 232, 0.55);
  --btn-hover-shadow: 0 8px 18px rgba(0, 0, 0, 0.18);
  --btn-hover-bg: #ffffff;

  /* Original MDL-ish FAB accent */
  --fab-accent: #ff4081;

    /* Credentials toolbar icon button color */
    --toolbar-color: #f4305b;
    --toolbar-color-hover: #28d940;
    --toolbar-color-active: #3721b6;
}

/* Global button styling: rectangle corners everywhere */
.btn,
button,
input[type="button"],
input[type="submit"],
input[type="reset"],
[role="button"] {
  border-radius: 0 !important;
}

/* But keep explicitly circular buttons circular (FABs, close buttons, etc.) */
.btn.btn-circle {
  border-radius: 9999px !important;
}

/* Global hover: shadow + light background (no outline)
   Keep filled DaisyUI buttons (primary/secondary/etc.) using their own hover colors. */
.btn:not(.btn-disabled):not(:disabled):not(.btn-primary):not(.btn-secondary):not(.btn-accent):not(.btn-info):not(.btn-success):not(.btn-warning):not(.btn-error):hover {
  outline: none;
  background-color: var(--btn-hover-bg) !important;
  box-shadow: var(--btn-hover-shadow);
}

button:not(.btn):not(:disabled):hover,
input[type="button"]:not(:disabled):hover,
input[type="submit"]:not(:disabled):hover,
input[type="reset"]:not(:disabled):hover,
[role="button"]:not([aria-disabled="true"]):hover {
  outline: none;
  background-color: var(--btn-hover-bg);
  box-shadow: var(--btn-hover-shadow);
}

/* Global keyboard focus: keep a rectangular outline + shadow */
.btn:not(.btn-disabled):not(:disabled):not(.btn-primary):not(.btn-secondary):not(.btn-accent):not(.btn-info):not(.btn-success):not(.btn-warning):not(.btn-error):focus-visible,
button:not(.btn):not(:disabled):focus-visible,
input[type="button"]:not(:disabled):focus-visible,
input[type="submit"]:not(:disabled):focus-visible,
input[type="reset"]:not(:disabled):focus-visible,
[role="button"]:not([aria-disabled="true"]):focus-visible {
  outline: 2px solid var(--btn-hover-outline);
  outline-offset: 0;
  background-color: var(--btn-hover-bg);
  box-shadow: var(--btn-hover-shadow);
}

/* Material Symbols baseline (replaces legacy Material Icons) */
.material-symbols-outlined {
  font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
  display: inline-block;
  vertical-align: middle;
  line-height: 1;
  user-select: none;
}

.cloak {
  visibility: hidden;
}

/* Header title link (used in index.html and cbor.html) */
.title-link {
  color: inherit; /* match surrounding header text */
  text-decoration: none; /* remove underline */
  display: inline-block;
}
.title-link:focus, .title-link:hover {
  text-decoration: underline; /* subtle affordance on hover/focus */
}

/* Link-style buttons should match the old UI: uppercase, no underline */
.btn.btn-link {
  text-decoration: none !important;
  text-transform: uppercase;
  font-weight: 500;
  color: var(--action-blue) !important;
}
.btn.btn-link:hover,
.btn.btn-link:focus {
  text-decoration: none !important;
}

/* Credential card action row: match old all-caps actions (scope to credential cards only) */
#credentialsContainer .card-actions .btn {
  text-transform: uppercase;
  font-weight: 500;
  color: var(--action-blue) !important;
}

/* Old-UI button text color for non-filled buttons */
.btn.btn-ghost,
.btn.btn-outline {
  color: var(--action-blue) !important;
}

/* When the UI disables all controls during an in-progress action, DaisyUI can
   render ghost/outline/link buttons with a grey filled background, which looks
   like they're "active". Keep these disabled buttons transparent and muted. */
.btn.btn-ghost:disabled,
.btn.btn-link:disabled,
.btn.btn-outline:disabled,
.btn.btn-ghost.btn-disabled,
.btn.btn-link.btn-disabled,
.btn.btn-outline.btn-disabled {
  background-color: transparent !important;
  box-shadow: none !important;
}

.btn.btn-ghost:disabled,
.btn.btn-link:disabled,
.btn.btn-outline:disabled {
  opacity: 0.55;
}

.btn.btn-outline:disabled,
.btn.btn-outline.btn-disabled {
  border-color: rgba(0, 0, 0, 0.18) !important;
}

/* Header Sign out should match old action styling (scoped to the top navbar only) */
.navbar #signOutButton {
  text-transform: uppercase;
  font-weight: 400;
  color: #fff !important;
}

/* Keep Sign out readable on the dark header (override global .btn:hover white background) */
.navbar #signOutButton:not(.btn-disabled):not(:disabled):hover {
  background: rgba(255,255,255,0.14) !important;
  box-shadow: none !important;
}

.navbar #signOutButton:not(.btn-disabled):not(:disabled):focus-visible {
  outline: 2px solid rgba(255,255,255,0.65) !important;
  outline-offset: 2px;
  background: rgba(255,255,255,0.14) !important;
  box-shadow: none !important;
}

/* Dialog buttons/links: match old UI (uppercase, no underline) */
dialog.app-dialog .btn {
  text-transform: uppercase;
  font-weight: 500;
  /* Keep filled buttons readable; only force blue for non-filled styles */
}

dialog.app-dialog .btn.btn-link {
  text-decoration: none !important;
}

dialog.app-dialog .btn.btn-ghost,
dialog.app-dialog .btn.btn-outline,
dialog.app-dialog .btn.btn-link {
  color: var(--action-blue) !important;
}

dialog.app-dialog .btn.btn-link:hover,
dialog.app-dialog .btn.btn-link:focus {
  text-decoration: none !important;
}

/* Reset Order buttons: remove outline/border everywhere */
#algorithmsResetOrder,
#hintsResetOrderCreate,
#hintsResetOrderGet {
  border: 0 !important;
  box-shadow: none !important;
  background: transparent !important;
}

/* Remove the progress line shown at the top of Create/Get dialogs */
#createDialog .loading-indicator,
#getDialog .loading-indicator {
  display: none !important;
}


p {
  font-size: 14px;
  margin: 0 0 8px 0px;
  word-wrap: break-word;
}

.highlighted {
  animation: 2000ms linear 0ms normal highlightedKeyframes;
}

/* Small numeric inputs for fake exclude credential controls */
.small-number-input {
  width: 90px; /* compact width */
  box-sizing: border-box;
}

.float-right {
  float: right;
}

/* Credentials layout: enforce a responsive multi-column grid regardless of utility availability */
#credentialsContainer {
  display: grid;
  gap: 16px;
  /* Use as many columns as fit, but keep cards readable */
  grid-template-columns: repeat(auto-fit, minmax(360px, 1fr));
  /* Stretch cards to the tallest item in the row for equal-height rows */
  align-items: stretch;
  /* Give cards breathing room from the viewport edges */
  padding-left: clamp(8px, 2vw, 16px);
  padding-right: clamp(8px, 2vw, 16px);
  /* Tiny bottom buffer so the last card's border/shadow isn't visually clipped */
  padding-bottom: 12px;
}

/* Credential cards: rectangular outline + shadow (no rounded corners) */
#credentialsContainer .card {
  border-radius: 0 !important;
  /* MDL-like elevation (original app feel) */
  box-shadow: 0 2px 2px 0 rgba(0,0,0,0.14), 0 3px 1px -2px rgba(0,0,0,0.20), 0 1px 5px 0 rgba(0,0,0,0.12);
  /* Make the entire card fill the grid row height */
  height: 100%;
  display: flex;
  flex-direction: column;
}

/* Let the card body take remaining height so actions can sit at the bottom */
#credentialsContainer .card .card-body {
  flex: 1 1 auto;
}

/* Credential username at top of each card: slightly larger + lighter */
#credentialsContainer .card .card-title {
  font-size: 22px !important;
  font-weight: 400;
  line-height: 1.3;
}

/* Credential card bottom actions: add breathing room and consistent spacing */
#credentialsContainer .card-actions {
  /* Thin separator line above the bottom actions (matches original) */
  border-top: 1px solid rgba(0,0,0,0.12);
  padding: 12px 12px 14px;
  margin-top: 10px;
  gap: 12px;
  /* Pin actions to the bottom of the card */
  margin-top: auto;
}

@media (max-width: 420px) {
  #credentialsContainer {
    grid-template-columns: 1fr;
  }
}

.app-dialog-content {
  font-size: 16px;
  /* Allow dialog content to flex and scroll when dialog height is constrained
     by the viewport. Using flex on the dialog container (see dialog.app-dialog)
     plus min-height:0 here ensures overflow-y works reliably across browsers. */
  flex: 1 1 auto;
  min-height: 0;
  overflow-y: auto;
  padding: 20px 24px;
  color: oklch(var(--bc));
}

dialog.app-dialog {
  min-width: 280px;
}

@media (max-width: 600px) {
  dialog.app-dialog {
    min-width: 0;
  }
}

/* Hybrid layout: flex single column on narrow screens, masonry-style columns on wide screens to reduce vertical gaps */
#createDialog { width: clamp(200px, 95vw, 400px); max-width:calc(100vw - 40px); min-width: 0; }
@media (max-width: 600px) {
  #createDialog { width: calc(100vw - 40px); max-width: 360px; }
}

/* Align controls within Create dialog rows (dropdowns, etc.).
   The markup uses floats; setting a consistent select width makes right edges align. */
#createDialog {
  --create-control-width: min(240px, 46vw);
}

/* Single-column mode (below wide-screen breakpoint): stack labels and controls (avoid float-right misalignment). */
@media (max-width: 899px) {
  #createDialog {
    --create-control-width: 100%;
  }

  #createDialog .app-dialog-content > span {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  #createDialog .app-dialog-content .float-right {
    float: none;
    align-self: stretch;
  }

  #createDialog .app-dialog-content select.select.float-right,
  #createDialog .app-dialog-content input.float-right {
    width: 100% !important;
    max-width: none !important;
  }
}

@media (min-width: 900px) {
  #createDialog {
    --create-control-width: 260px;
  }
}

#createDialog .app-dialog-content select.select {
  width: var(--create-control-width) !important;
  max-width: none !important;
  box-sizing: border-box;
}

/* Full-width text inputs in Create dialog (clear the floated select in the same block). */
#createDialog #create_credBlob,
#createDialog #create_prf_first,
#createDialog #create_prf_second {
  display: block;
  width: 100% !important;
  max-width: none !important;
  box-sizing: border-box;
  clear: both;
}

/* Extra separation between PRF inputs */
#createDialog #create_prf_second {
  margin-top: 10px !important;
}

/* Space between PRF enable dropdown and first PRF input */
#createDialog #create_prf {
  margin-bottom: 10px;
}

/* Checkbox rows inside Create dialog: keep text close to the box (avoid DaisyUI space-between). */
#createDialog .app-dialog-content label.label {
  justify-content: flex-start;
  gap: 10px;
}

#createDialog .app-dialog-content label.label .label-text {
  margin-left: 0;
  font-size: inherit;
  font-weight: inherit;
  line-height: inherit;
}

/* Wide-screen layout: make the dialog wider and flow option blocks into 2 columns.
   NOTE: These need to win the cascade against the base (mobile-first) rules below. */
@media (min-width: 900px) {
  #createDialog {
    width: clamp(720px, 92vw, 1040px);
    max-width: calc(100vw - 48px);
  }

  #createDialog .app-dialog-content {
    /* Wide-screen: the content area stays vertically scrollable.
       The masonry layout is provided by an inner two-column wrapper. */
    display: block !important;
    max-height: 88vh !important;
    padding: 10px !important;
  }

  #createDialog .create-dialog-columns {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 10px;
  }

  #createDialog .create-dialog-col {
    display: flex;
    flex-direction: column;
    gap: 10px;
    min-width: 0;
  }

  /* Algorithms + Hints: use a simple vertical flex stack (no grid). */
  #createDialog #create_algorithmsList,
  #createDialog #create_hintsList {
    display: flex;
    flex-direction: column;
  }
}

@media (min-width: 1200px) {
  #createDialog {
    width: clamp(880px, 92vw, 1240px);
  }
}
#createDialog .app-dialog-content {
  max-height: 75vh;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 8px;
  display: flex;
  flex-direction: column;
  gap: 10px; /* spacing for single column */
  -webkit-overflow-scrolling: touch; /* Enable smooth scrolling on Safari/iOS */
}

/* Mobile Chrome iOS fix - reduce content height to ensure actions visible */
@supports (-webkit-touch-callout: none) {
  #createDialog .app-dialog-content {
    max-height: 60vh;
  }
  
  @media (max-height: 700px) {
    #createDialog .app-dialog-content {
      max-height: 50vh;
    }
  }
}
#createDialog .app-dialog-content > hr { display:none; }
#createDialog .app-dialog-content > span,
#createDialog .app-dialog-content .create-dialog-col > span {
  background:#fafafa;
  border:1px solid #e5e5e5;
  border-radius:4px;
  padding:6px 12px;
  margin: 0;
  box-sizing: border-box;
  flex-shrink: 0; /* Prevent items from shrinking */
}

/* Align controls within Get dialog rows (dropdowns, etc.). */
#getDialog {
  --get-control-width: min(240px, 46vw);
}

@media (min-width: 900px) {
  #getDialog {
    --get-control-width: 260px;
  }
}

#getDialog .app-dialog-content select.select {
  width: var(--get-control-width) !important;
  max-width: none !important;
  box-sizing: border-box;
}

/* Full-width text inputs in Get dialog (clear any floated selects in the same block). */
#getDialog #get_conditionalUI,
#getDialog #get_largeBlobText,
#getDialog #get_prf_first,
#getDialog #get_prf_second {
  display: block;
  width: 100% !important;
  max-width: none !important;
  box-sizing: border-box;
  clear: both;
}

/* Extra separation between PRF inputs (Get) */
#getDialog #get_prf_second {
  margin-top: 10px !important;
}

/* Single-column mode (below wide-screen breakpoint): stack labels and controls in Get dialog. */
@media (max-width: 899px) {
  #getDialog {
    --get-control-width: 100%;
  }

  #getDialog .app-dialog-content > span {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  #getDialog .app-dialog-content .float-right {
    float: none;
    align-self: stretch;
  }

  #getDialog .app-dialog-content select.select.float-right,
  #getDialog .app-dialog-content input.float-right {
    width: 100% !important;
    max-width: none !important;
  }
}

/* Checkbox rows inside Get dialog: keep text close to the box (avoid DaisyUI space-between). */
#getDialog .app-dialog-content label.label {
  justify-content: flex-start;
  gap: 10px;
}

#getDialog .app-dialog-content label.label .label-text {
  margin-left: 0;
  font-size: inherit;
  font-weight: inherit;
  line-height: inherit;
}


/* Hybrid layout for Authenticate Options dialog */
#getDialog { width: clamp(200px, 95vw, 400px); max-width:calc(100vw - 40px); min-width: 0; }
@media (max-width: 600px) {
  #getDialog { width: calc(100vw - 40px); max-width: 360px; }
}

/* Wide-screen Get dialog: match Create dialog (wider + masonry-style two columns via inner wrapper) */
@media (min-width: 900px) {
  #getDialog {
    width: clamp(720px, 92vw, 1040px);
    max-width: calc(100vw - 48px);
  }

  #getDialog .app-dialog-content {
    display: block !important;
    max-height: 88vh !important;
    padding: 10px !important;
  }

  #getDialog .get-dialog-columns {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 10px;
  }

  #getDialog .get-dialog-col {
    display: flex;
    flex-direction: column;
    gap: 10px;
    min-width: 0;
  }

  #getDialog #get_hintsList {
    display: flex;
    flex-direction: column;
  }
}

@media (min-width: 1200px) {
  #getDialog {
    width: clamp(880px, 92vw, 1240px);
  }
}
#getDialog .app-dialog-content {
  max-height: 75vh;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 12px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  -webkit-overflow-scrolling: touch;
}

/* Mobile Chrome iOS fix - reduce content height to ensure actions visible */
@supports (-webkit-touch-callout: none) {
  #getDialog .app-dialog-content {
    max-height: 60vh;
  }
  
  @media (max-height: 700px) {
    #getDialog .app-dialog-content {
      max-height: 50vh;
    }
  }
}
#getDialog .app-dialog-content > hr { display:none; }
#getDialog .app-dialog-content > span,
#getDialog .app-dialog-content .get-dialog-col > span {
  background:#fafafa;
  border:1px solid #e5e5e5;
  border-radius:4px;
  padding:6px 12px;
  margin: 0;
  box-sizing: border-box;
  flex-shrink: 0;
}


/* Narrow screens remain single column automatically; no horizontal scroll due to width clamp */

/* Dialog sizing: keep key dialogs responsive and similar widths */
/* Use a clamp-based width so these dialogs expand on wider screens but remain usable on small viewports. */
#creationDataDialog,
#authenticationDataDialog {
  width: clamp(480px, 60vw, 1100px);
  max-width: 95vw;
  min-width: 420px;
}

@keyframes highlightedKeyframes {
  0% {
    background-color: #FFFFFF;
  }
  50% {
    background-color: #00897b;
  }
  100% {
    background-color: #FFFFFF;
  }
}

dialog.app-dialog {
  width: 400px;
  /* Keep the dialog from exceeding the viewport height and allow
    its inner content area to scroll when needed. Use flexbox so
    header/title and actions keep their intrinsic size while the
    content area takes the remaining space and becomes scrollable. */
  margin: 24px auto;
  max-height: calc(100vh - 48px);
  flex-direction: column;
  overflow: hidden; /* clip outer overflow; inner content scrolls */
  border: 1px solid oklch(var(--b3));
  border-radius: 1rem;
  background: oklch(var(--b1));
}

/* Register a passkey dialog: square corners */
#createDialog {
  border-radius: 0 !important;
}

#createDialog .app-dialog-content > span,
#createDialog .app-dialog-content .create-dialog-col > span {
  border-radius: 0 !important;
}

/* Authenticate dialog: square corners */
#getDialog {
  border-radius: 0 !important;
}

#getDialog .app-dialog-content > span {
  border-radius: 0 !important;
}

#getDialog .app-dialog-content .get-dialog-col > span {
  border-radius: 0 !important;
}

/* More Options dialog: improve layout and avoid horizontal clipping */
#moreDialog {
  width: clamp(420px, 55vw, 760px);
  max-width: 95vw;
  border-radius: 0 !important;
}

#moreDialog .app-dialog-content {
  display: flex;
  flex-direction: column;
  gap: 12px;
  overflow-x: hidden;
}

#moreDialog .more-kv {
  display: flex;
  align-items: baseline;
  gap: 12px;
  padding: 10px 12px;
  background: #fafafa;
  border: 1px solid #e5e5e5;
  border-radius: 4px;
}

#moreDialog .more-label {
  flex: 1 1 auto;
  min-width: 0;
  font-weight: 600;
  color: #333;
}

#moreDialog .more-value {
  flex: 0 0 auto;
  margin-left: auto;
  font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Monaco, 'Roboto Mono', 'Segoe UI Mono', 'Liberation Mono', monospace;
  font-size: 13px;
  color: #555;
}

#moreDialog .more-capabilities {
  padding: 10px 12px;
  background: #fafafa;
  border: 1px solid #e5e5e5;
  border-radius: 4px;
}

/* Capabilities table: full width, wrap long capability names, no horizontal scroll */
#moreDialog_ClientCapabilities {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed;
}

#moreDialog_ClientCapabilities th,
#moreDialog_ClientCapabilities td {
  padding: 8px 10px;
  border-top: 1px solid rgba(0,0,0,0.08);
  vertical-align: top;
  word-break: break-word;
  overflow-wrap: anywhere;
}

#moreDialog_ClientCapabilities tr:first-child th {
  border-top: 0;
}

#moreDialog_ClientCapabilities th {
  font-weight: 700;
  color: #333;
}

#moreDialog_ClientCapabilities th:first-child,
#moreDialog_ClientCapabilities td:first-child {
  width: calc(100% - 140px);
  text-align: left;
}

#moreDialog_ClientCapabilities th:last-child,
#moreDialog_ClientCapabilities td:last-child {
  width: 140px;
  text-align: right;
  font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Monaco, 'Roboto Mono', 'Segoe UI Mono', 'Liberation Mono', monospace;
  font-size: 13px;
  color: #555;
}

#moreDialog_ClientCapabilities tr:nth-child(odd):not(:first-child) {
  background: rgba(0,0,0,0.02);
}

/* Only force flex layout while the dialog is open.
   (Closed <dialog> elements should remain display:none per UA styles.) */
dialog.app-dialog[open] {
  display: flex;
}

dialog.app-dialog::backdrop {
  background: rgba(0,0,0,.45);
}

/* Mobile-specific adjustments for Chrome on iOS */
@supports (-webkit-touch-callout: none) {
  /* iOS Safari and Chrome specific */
  dialog.app-dialog {
    /* Use smaller viewport unit to account for browser UI */
    max-height: calc(100vh - 80px);
    margin: 20px auto;
  }
  
  /* Extra safety for very small screens */
  @media (max-height: 700px) {
    dialog.app-dialog {
      max-height: 90vh;
      margin: 16px auto;
    }
  }
}

.app-dialog-title {
  padding: 24px 24px 0;
  margin: 0;
  font-size: 1.5rem;
}

.app-dialog-actions {
  padding: 12px 24px 18px 24px;
  display: flex;
  gap: 8px;
  /* Most dialogs have primary action first in the DOM. Reverse the visual
     order so the primary action appears on the far right (like the reference). */
  flex-direction: row-reverse;
  justify-content: flex-start;
  flex-wrap: wrap;
  flex-shrink: 0;
  background: oklch(var(--b1));
}

/* Floating top-right quick actions (Create/Get/More/CBOR) */
.app-fab {
  position: fixed;
  top: 84px;
  right: 16px;
  display: flex;
  gap: 10px;
  z-index: 60;
}

/* Give the floating buttons a bit more presence (closer to the original FAB feel) */
.app-fab .btn {
  box-shadow: 0 6px 18px rgba(0,0,0,0.22);
  width: 48px;
  height: 48px;
  min-height: 48px;
  padding: 0;
  border-radius: 9999px !important;
  background-color: var(--fab-accent) !important;
  border-color: var(--fab-accent) !important;
  color: #fff !important;
}

.app-fab .btn:hover {
  background-color: #f50057 !important;
  border-color: #f50057 !important;
}

.app-fab .btn:active {
  background-color: #e0004d !important;
  border-color: #e0004d !important;
}

.app-fab .material-symbols-outlined {
  font-size: 32px;
  line-height: 32px;
}

@media (max-width: 520px) {
  .app-fab {
    top: 76px;
    right: 12px;
    gap: 8px;
  }

  .app-fab .btn {
    width: 44px;
    height: 44px;
    min-height: 44px;
  }

  .app-fab .material-symbols-outlined {
    font-size: 28px;
    line-height: 28px;
  }
}

/* Header sizing: keep it closer to the original bigger top bar */
header.navbar {
  min-height: 72px;
  padding: 12px 16px;
}

header.navbar .navbar-start h1 {
  font-size: 32px;
  font-weight: 400;
  margin: 0;
}

header.navbar #signOutButton {
  height: 40px;
  min-height: 40px;
  padding: 0 14px;
  font-size: 18px;
}

/* Section title under header (Credentials) */
main h2 {
  font-size: 24px;
}

.mt-10 {
  margin-top: 10px;
}

#loginHeader {
  text-align: center;
  margin-bottom: 5px;
}

/* Login page: center card + constrain username width even without utilities */
body#signInPrompt {
  min-height: 100vh;
  display: flex;
}

body#signInPrompt > main {
  width: 100%;
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 16px;
}

body#signInPrompt .login-shell {
  width: 100%;
  max-width: 360px;
}

/* Login title: force size/weight even if utility classes are missing */
body#signInPrompt .login-title {
  font-size: 24px;
  font-weight: 500;
  line-height: 1.15;
  letter-spacing: -0.01em;
}

/* Credentials header row: title + icon actions (matches reference-style toolbar) */
.credentials-toolbar {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  padding: 0 16px;
  min-height: 56px;
  margin-bottom: 12px;
  background: var(--toolbar-color-active);
  color: #fff;
  position: relative;
  overflow: hidden;
  border: none;
}

.credentials-title {
  margin: 0;
  color: #fff;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  font-weight: 400;
  font-size: 18px !important;
}

.credentials-toolbar-actions {
  display: flex;
  align-items: center;
  width: 100%;
  gap: 6px;
}

.credentials-toolbar-left {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  flex: 1 1 auto;
}

/* Keep the Sign out icon on the far right */
.credentials-toolbar-actions #signOutButton {
  margin-left: auto;
}

/* CBOR page: center the navigation icons in the toolbar */
.cbor-page .cbor-nav-toolbar-actions {
  justify-content: center;
}

/* Icon buttons in the Credentials toolbar */
.credentials-toolbar-actions .btn {
  width: 48px;
  height: 48px;
  min-height: 48px;
  padding: 0;
  border-radius: 9999px !important;
  background-color: var(--toolbar-color) !important;
  border: 1px solid var(--toolbar-color) !important;
  box-shadow: 0 4px 10px rgba(0,0,0,0.16) !important;
  color: #fff !important;
}

/* Override the global .btn:hover (very high specificity due to many :not() clauses) */
.credentials-toolbar-actions .btn.btn-ghost.btn-circle.btn-sm:not(.btn-disabled):not(:disabled):not(.btn-primary):not(.btn-secondary):not(.btn-accent):not(.btn-info):not(.btn-success):not(.btn-warning):not(.btn-error):hover,
.credentials-toolbar-actions .btn.btn-ghost.btn-circle.btn-sm:not(.btn-disabled):not(:disabled):not(.btn-primary):not(.btn-secondary):not(.btn-accent):not(.btn-info):not(.btn-success):not(.btn-warning):not(.btn-error):focus-visible {
  background-color: var(--toolbar-color-hover) !important;
  border-color: var(--toolbar-color-hover) !important;
  color: #fff !important;
  outline: none !important;
  box-shadow: 0 6px 14px rgba(0,0,0,0.20) !important;
}

.credentials-toolbar-actions .btn:active {
  background-color: var(--toolbar-color-active) !important;
  border-color: var(--toolbar-color-active) !important;
}

.credentials-toolbar-actions .material-symbols-outlined {
  font-size: 26px;
  line-height: 26px;
}

/* Make the Sign In button match the input width */
body#signInPrompt .card-actions {
  display: block;
}

body#signInPrompt #signInButton {
  width: 100%;
  display: block;
  color: #fff !important;
}

#loginFooter {
  text-align: center;
  margin-top: 15px;
}

.footer-links {
  text-align: center;
  margin: 40px 0 30px;
  font-size: 12px;
  color: #666;
}

.footer-links a {
  color: rgb(63, 81, 181);
}

.footer-links a:hover {
  text-decoration: underline;
}

/* Visually indicate disabled credentials */
.cred-disabled {
  opacity: 0.85;
  filter: grayscale(0.15);
}
.cred-disabled .reg-data-list,
.cred-disabled .reg-data-body,
.cred-disabled .reg-data-header,
.cred-disabled pre,
.cred-disabled .mono,
.cred-disabled dt,
.cred-disabled dd {
  color: #8a8a8a;
}
/* Disabled credential cards: disable all action buttons except the toggle */
.cred-disabled .card-actions a:not(.toggleEnabledButton),
.cred-disabled .card-actions button:not(.toggleEnabledButton) {
  opacity: 0.45 !important;
  pointer-events: none !important;
  cursor: default !important;
  color: #9e9e9e !important;
}
/* Keep the enable/disable toggle fully visible and interactive */
.cred-disabled .toggleEnabledButton {
  opacity: 1 !important;
  pointer-events: auto !important;
}
/* Disable Authenticate button on disabled cards (non-interactive and visibly muted) */
.cred-disabled .authenticateCredentialButton {
  opacity: 0.45 !important;
  pointer-events: none !important;
  cursor: default !important;
  color: #9e9e9e !important;
}


/* Authenticator AAGUID name label inserted above mono-blocks */
.aaguid-name {
  font-size: 13px;
  color: #333;
  line-height: 1.2;
  margin-bottom: 6px;
  white-space: normal; /* allow wrapping */
}

.aaguid-name::after {
  content: '';
  display: block;
  height: 0;
}

/* AAGUID mono-block layout: four columns â€” text | icon | mds | copy
   Make icon/actions columns fixed-width so buttons line up. */
.aaguid-mono-block {
  display: grid;
  grid-template-columns: 1fr 44px 44px 44px; /* text (fluid) | icon | mds | copy */
  gap: 8px; /* match .mono-block default */
  align-items: center;
}
.aaguid-mono-block { width: 100%; grid-auto-flow: column; }
.aaguid-icon-wrap { width: 44px; display: flex; align-items: center; justify-content: center; }
.aaguid-icon { width: 32px; height: 32px; object-fit: contain; border-radius: 4px; }
/* Keep the pre styling (background/padding) so the rounded rectangle appears around the AAGUID text */

/* Mono block wrapper: positions a small copy button top-right of pre blocks */
.mono-block {
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 8px;
  align-items: start;
  width: 100%;
}
.mono-block .copy-to-clipboard {
  width: 44px !important;
  min-width: 44px !important;
  height: 44px !important;
  padding: 8px !important;
}
.mono-block pre.mono {
  max-height: var(--mono-max-height);
  overflow: auto;
  padding: 12px;
  box-sizing: border-box;
  min-width: 0; /* allow shrink in constrained containers */
  width: 100%;
}

/* Ensure AAGUID mono-block uses a three-column grid even though .mono-block sets a different template.
   Specific selector (.mono-block.aaguid-mono-block) ensures this rule wins. */
.mono-block.aaguid-mono-block {
  grid-template-columns: 1fr 44px 44px 44px !important;
  display: grid;
  gap: 8px;
  align-items: center;
}

/* Force column placement so order is guaranteed regardless of DOM or inherited styles */
.aaguid-mono-block > pre.mono { grid-column: 1 / 2; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; writing-mode: horizontal-tb; }
.aaguid-mono-block > .aaguid-icon-wrap { grid-column: 2 / 3; }
.aaguid-mono-block > .aaguid-mds-actions { grid-column: 3 / 4; }
/* Place only the copy action in the last column; don't override the MDS action. */
.aaguid-mono-block > .mono-actions:not(.aaguid-mds-actions) { grid-column: 4 / 5; }
/* allow the text column to shrink inside the grid instead of forcing wrapping */
.aaguid-mono-block > pre.mono { min-width: 0; }

/* Ensure mono-block inside reg-data-list dd participates properly in dd's layout */
.reg-data-list dd > .mono-block { flex: 1 1 auto; min-width: 0; display: grid; }

/* Header-style bar placed above the mono pre */
.mono-actions {
  display: flex;
  align-items: center;
  justify-content: center;
  padding-left: 0;
  /* Reserve space so the mono-block width doesn't change when the button is hidden */
  width: 44px; /* matches typical action button tappable area */
  min-width: 44px;
}
.mono-actions .btn { min-width: 44px; height: 44px; padding: 8px; }
.mono-actions .btn {
  width: 44px !important;
  min-width: 44px !important;
  height: 44px !important;
  padding: 8px !important;
}

@media (max-width: 640px) {
  .mono-block { grid-template-columns: 1fr; }
  /* On narrow screens collapse to a single column and let actions flow naturally */
  .mono-actions { margin-left: 0; margin-top: 8px; justify-content: flex-start; width: auto; min-width: 0; }
}

/* AAGUID responsive: on narrow screens show text on first row, icon+copy on second row */
@media (max-width: 640px) {
  .mono-block.aaguid-mono-block {
    display: grid !important;
    grid-template-columns: 1fr 44px 44px !important; /* text | icon | actions */
    grid-template-rows: auto auto !important;
    grid-template-areas: 
      "text text text"
      "icon mds actions";
    gap: 8px;
    width: 100%;
  }
  .aaguid-mono-block > pre.mono {
    grid-area: text;
    white-space: normal; /* allow wrapping on narrow screens */
    overflow: visible;
    min-width: 0;
  }
  .aaguid-mono-block > .aaguid-icon-wrap { grid-area: icon; justify-content: flex-start; }
  .aaguid-mono-block > .aaguid-mds-actions { grid-area: mds; justify-content: center; }
  .aaguid-mono-block > .mono-actions:not(.aaguid-mds-actions) { grid-area: actions; justify-content: center; }
}

/* Algorithm priority list */
.alg-list { list-style: none; margin: 0 0 8px 0; padding: 0; }
.alg-list li { display: flex; align-items: center; justify-content: space-between; padding: 4px 0; border-bottom: 1px solid #eee; }
.alg-list li:last-child { border-bottom: none; }

/* Algorithms/Hints list: keep checkbox and text separated */
#createDialog .alg-list label.label {
  display: flex;
  align-items: center;
  gap: 10px;
}

#createDialog .alg-list label.label .label-text {
  margin-left: 0;
}
.alg-actions { display: flex; gap: 4px; }
.alg-actions button { background: transparent; border: 1px solid #ccc; border-radius: 3px; cursor: pointer; padding: 2px 6px; font-size: 12px; line-height: 1; color: #3f51b5; }
.alg-actions button:hover { background: #f5f5f5; }
.alg-actions button:disabled { opacity: 0.3; cursor: default; }
.alg-warning { color: #d32f2f; font-size: 12px; margin: 4px 0 8px; }

/* View Certificates icon button in credential cards */
.view-cert-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background: transparent;
  border: none;
  cursor: pointer;
  color: #3f51b5; /* primary color */
  text-decoration: none;
}
.view-cert-btn .material-symbols-outlined { font-size: 20px; line-height: 20px; }
.view-cert-btn:hover {
  background: rgba(63,81,181,0.08);
}
.card-actions .view-cert-btn { margin-left: 8px; }

/* Copy button next to credential ID: visually similar to cert-copy-fingerprint */
.cred-copy-id {
  padding: 6px 8px !important;
  min-width: 0 !important;
  height: 36px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: transparent !important;
  color: #1a73e8 !important;
  border: none !important;
}
.cred-copy-id .material-symbols-outlined { font-size:18px !important; color: inherit !important; }

/* AAGUID copy button style mirrors Credential ID copy button */
.aaguid-copy-id { padding: 6px 8px !important; min-width: 0 !important; height: 36px; display: inline-flex; align-items: center; justify-content: center; background: transparent !important; color: #1a73e8 !important; border: none !important; }
.aaguid-copy-id .material-symbols-outlined { font-size:18px !important; color: inherit !important; }

/* Registration summary block in credential cards */
.reg-data { margin-top: 8px; padding: 8px 10px; background: #fafafa; border: 1px solid #eee; border-radius: 4px; }
.reg-data-header { display:flex; align-items:center; gap:8px; margin-bottom:6px; }
.reg-data-controls { margin-left: auto; display:flex; gap:8px; align-items:center; }
.reg-data-list { margin:0; padding:0; display:block; }
.reg-data-list dt { font-weight:500; color:#333; margin: 12px 0 4px 0; }
.reg-data-list dd { margin:0 0 12px 0; color:#555; display:block; align-items:baseline; gap:8px; overflow-wrap:anywhere; word-break:normal; }
.reg-data-list dd::before { content: ""; }
.reg-data-list dd .credential-id { display:block; min-width:0; white-space:normal; overflow-wrap:anywhere; word-break:break-all; }

.reg-data-body { display:block; }
.reg-data-body.collapsed { display:none; }

.reg-data-toggle { padding:6px; min-width:0; height:36px; display:inline-flex; align-items:center; justify-content:center; }

/* Transport chips for credential transports */
/* Transport chips for credential transports (non-interactive decorative chips) */
/* Small spacing helper for MDL chips inside reg-data */

.reg-data .transport-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
  width: 100%;
}

.reg-data .transport-item {
  width: 100%;
  justify-content: flex-start;
  align-items: center;
  padding: 10px 12px;
  font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Monaco, 'Roboto Mono', 'Segoe UI Mono', 'Liberation Mono', monospace;
  font-size: 13px;
  font-weight: 400;
  line-height: 1.25;
  color: #555;
  white-space: normal;
}

.reg-data .transport-item.badge {
  border-radius: 4px;
  background: #dbdde2;
  border: 1px solid #e5e7eb;
  color: inherit;
  text-transform: none;
}


/* DECODE button placement inside reg-data/dialog content: ensure button sits below its related value */
.decode-action { margin-top: 6px; }
.decode-action .btn { padding: 6px 8px !important; min-width: 0 !important; height: 36px; }

/* Ensure decode-action sits on its own row inside the registration data dd (which is a flex container) */
.reg-data-list dd > span { flex: 1 1 auto; min-width: 0; display: block; }
.reg-data-list dd > .mono { flex: 1 1 auto; min-width: 0; display: block; }
.reg-data-list dd .decode-action { flex: 0 0 100%; display:flex; gap:8px; justify-content:flex-start; margin-top:6px; }

/* Monospace block used for long hex/CBOR/JSON values inside dialogs/cards */
.mono {
  /* Use the same mono font stack and size as certificate public key blocks to avoid wrapping */
  font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Monaco, 'Roboto Mono', 'Segoe UI Mono', 'Liberation Mono', monospace;
  font-size: 13px;
  white-space: pre-wrap !important;
  word-break: normal !important;
  overflow-wrap: anywhere !important;
  margin: 0; /* reset pre default margins inside dd */
  padding: 0; /* keep inline with reg-data spacing */
  /* Limit height so huge hex/CBOR blobs don't expand the dialog; allow internal scrolling.
    Use the configurable --mono-max-height (viewport-relative) with a pixel fallback. */
  max-height: var(--mono-max-height, 260px);
  overflow-y: auto;
  /* Ensure the width calculation includes padding and border so a 100% width
     mono box (used elsewhere) stays inside its parent (.reg-data) and
     doesn't overflow the grey section boundary. */
  box-sizing: border-box;
  max-width: 100%;
  padding: 8px 6px;
  border: 1px solid rgba(0,0,0,0.06);
  border-radius: 4px;
}

/* Stronger enforcement: ensure mono blocks render horizontally and span available width */
.reg-data-list dd > .mono {
  width: 100% !important;
  writing-mode: horizontal-tb !important;
  text-orientation: mixed !important;
  line-height: 1.25 !important;
  white-space: pre-wrap !important;
  word-break: break-word !important;
  overflow-wrap: anywhere !important;
}

/* Left-column placement for DECODE action: sit under dt label in the left column */
.decode-action-left { margin-top:6px; }
.decode-action-left .btn { padding: 4px 6px !important; min-width: 0 !important; height: 28px; font-size: 12px; }

/* Responsive adjustments for credential cards and registration summary on narrow screens */
@media (max-width: 760px) {
  /* Stack labels above values for reg-data lists (single-column everywhere) */
  .reg-data-list { display: block; }
  .reg-data-list dt { font-size: 0.95em; }
  .reg-data-list dd { display:block; margin:0 0 8px 0; color:#555; }
  .reg-data-list dd .credential-id { word-break: break-word; }
  /* Ensure header buttons in reg-data-header wrap nicely */
  .reg-data-header { flex-wrap: wrap; gap:6px; }
}

/* Keep reg-data-list stacked at all widths: label above value */

/* Additional narrow-screen tweaks for credential cards */
@media (max-width: 760px) {
  /* Give reg-data a bit more breathing room for touch */
  .reg-data { padding: 12px; }

  /* Ensure long hex/ID text breaks properly */
  .reg-data-list dd, .reg-data-list dt { word-break: break-word; overflow-wrap: anywhere; }

  /* Make credential-id text smaller to fit when necessary */
  .reg-data-list dd .credential-id { font-size: 14px; }
}

/* Certificate dialog action buttons under each cert */
.cert-actions { display:flex; gap:8px; margin-top:8px; }
.cert-actions .material-symbols-outlined { vertical-align: middle; }

/* Make per-cert action buttons visually consistent */
#certsDialog .cert-actions .btn {
  display: inline-flex !important;
  align-items: center;
  gap: 8px;
  background: transparent !important;
  border: none !important;
  color: #1a73e8 !important; /* use a consistent primary/link color */
  text-transform: none !important;
  font-weight: 500 !important;
  padding: 6px 8px !important;
  min-width: 0 !important;
}

#certsDialog .cert-actions .btn .material-symbols-outlined {
  color: inherit !important;
  font-size: 20px !important;
  line-height: 20px !important;
}

/* hover effect to match other action links/buttons */
#certsDialog .cert-actions .btn:hover {
  background: var(--btn-hover-bg) !important;
}

/* Icon-only copy buttons next to fingerprint/serial */
/* Match per-cert action buttons */
#certsDialog .cert-copy-fingerprint,
#certsDialog .cert-copy-serial {
  padding: 6px 8px !important;
  min-width: 0 !important;
  height: 36px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: transparent !important;
  color: #1a73e8 !important;
  border: none !important;
}
#certsDialog .cert-copy-fingerprint .material-symbols-outlined,
#certsDialog .cert-copy-serial .material-symbols-outlined { font-size:18px !important; color: inherit !important; }

/* Public key copy button: same style as other copy icons */
#certsDialog .cert-copy-publickey {
  padding: 6px 8px !important;
  min-width: 0 !important;
  height: 36px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: transparent !important;
  color: #1a73e8 !important;
  border: none !important;
}
#certsDialog .cert-copy-publickey .material-symbols-outlined { font-size:18px !important; color: inherit !important; }

/* Responsive adjustments: allow per-cert action buttons to wrap and
   use a compact icon-first layout on narrow screens so label text doesn't
   overflow or get truncated. This keeps icons visible and tappable.
*/
@media (max-width: 520px) {
  /* Let the action buttons wrap to multiple lines */
  .cert-actions {
    flex-wrap: wrap;
    align-items: center;
  }

  /* Make each button a bit more compact and allow it to shrink */
  #certsDialog .cert-actions .btn {
    padding: 6px 6px !important;
    font-size: 13px !important;
    gap: 6px !important;
    min-width: 0 !important;
  }

  /* When space is very narrow, show an icon-first style where label can wrap
     onto the next line; ensure icons remain left-aligned and visible. */
  @media (max-width: 380px) {
    #certsDialog .cert-actions .btn {
      display: inline-flex !important;
      flex-direction: row !important;
      align-items: center !important;
      gap: 6px !important;
      padding: 6px 6px !important;
    }
    /* If necessary, hide the text on ultra-narrow screens but keep title accessible
       via title attribute (handled in JS if desired). We prefer to keep text when possible,
       so only reduce visibility using a subtle technique: shrink text and allow wrapping. */
    #certsDialog .cert-actions .btn { white-space: normal !important; }
  }
}

/* Make certificates dialog wider on larger screens */
/* Certificates dialog: prefer content-width but cap at a reasonable max */
dialog#certsDialog {
  width: auto;
  max-width: 1100px;
  /* add bottom padding so footer buttons aren't flush to the dialog edge */
  padding: 0 16px 24px;
}

/* Layout certificate cards as a single column (top-to-bottom). Each card
   stretches to fill the dialog content width so available space on the right
   is used. This keeps the vertical flow but makes entries flexible. */
#certsDialog .app-dialog-content {
  display: flex !important;
  flex-direction: column;
  gap: 16px;
  align-items: stretch;
}

/* Ensure each cert card uses the full width of the dialog content area */
#certsDialog .cert-card { width: 100%; box-sizing: border-box; }

.cert-dialog-actions { display:flex; gap:8px; align-items:center; }
/* Ensure actions sit at the bottom-right of the dialog and force LTR ordering
  so Download Chain appears on the left and Close on the right. Use
  explicit orders to survive MDL DOM upgrades. */
.cert-dialog-actions {
  margin-top: 12px;
  display: flex;
  gap: 8px;
  justify-content: space-between;
  align-items: center;
  /* create breathing room below the buttons */
  padding-bottom: 12px;
}

/* Force left-to-right direction inside the certs dialog to avoid RTL or
   MDL transforms that can reverse button order. Use !important to make
   these styles take precedence after runtime upgrades. */
#certsDialog {
  direction: ltr !important;
}
#certsDialog .cert-dialog-actions {
  direction: ltr !important;
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
}
/* Explicit ordering of footer children: left group first, right group second */
#certsDialog .cert-dialog-actions > div:first-child { order: 0 !important; }
#certsDialog .cert-dialog-actions > div:last-child { order: 1 !important; }
#certsDialog #certsDownloadChain { order: 0 !important; }
#certsDialog #certsDialog_x { order: 1 !important; }

/* Use explicit left/right flex containers so Download Chain stays left and
   Close stays right in a deterministic way that survives runtime DOM
   changes from MDL. The right container uses margin-left:auto to push it
   to the far right. */
#certsDialog .cert-dialog-actions {
  position: static !important;
  display: flex !important;
  align-items: center !important;
  gap: 8px !important;
  /* prefer single-row layout; allow wrapping only when necessary */
  flex-wrap: nowrap !important;
  flex-direction: row !important;
  justify-content: space-between !important;
}

#certsDialog .cert-actions-left {
  display: flex;
  gap: 8px;
  align-items: center;
}

#certsDialog .cert-actions-right {
  display: flex;
  gap: 8px;
  align-items: center;
  margin-left: auto !important; /* keep Close on the right */
}

/* Responsive fallback: on narrow viewports, revert to normal flow so buttons
   wrap and maintain accessibility on small screens. */
@media (max-width: 520px) {
  /* Keep footer actions as a flex container and preserve left/right
     alignment. Use margin-left:auto on the Close button to push it to the right.
     This avoids position:absolute issues while keeping the layout stable. */
  #certsDialog .cert-dialog-actions {
    position: static !important;
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    gap: 8px !important;
    flex-wrap: wrap;
  }

  #certsDialog #certsDownloadChain {
    position: static !important;
    order: 0 !important;
    margin-left: 0 !important;
  }

  /* On narrow screens, allow wrapping but keep the left group before the
     right group. Prefer to keep them on one row if space permits; when they
     wrap, the right group is right-aligned on its own row. */
  #certsDialog .cert-dialog-actions { flex-wrap: wrap !important; }

  #certsDialog .cert-actions-left {
    order: 0 !important;
    flex: 1 1 auto !important;
    display: flex !important;
    gap: 8px !important;
    align-items: center !important;
  }

  #certsDialog .cert-actions-right {
    order: 1 !important;
    flex: 0 0 auto !important;
    display: flex !important;
    gap: 8px !important;
    align-items: center !important;
    margin-left: auto !important; /* keep Close on the right */
    justify-content: flex-end !important;
  }
}

/* Strong enforcement for wide screens: ensure left then right ordering and
   single-row layout. This overrides MDL dialog defaults that sometimes
   reposition children. */
@media (min-width: 900px) {
  #certsDialog .cert-dialog-actions {
    flex-wrap: nowrap !important;
    justify-content: space-between !important;
  }
  #certsDialog .cert-actions-left { order: 0 !important; }
  #certsDialog .cert-actions-right { order: 1 !important; margin-left: auto !important; }
}

/* Improve cert card visuals */
.cert-card {
  border-radius: 4px;
  overflow: visible;
  padding-bottom: 8px;
  border: 1px solid rgba(0,0,0,0.08);
}
.cert-card small { color: #555; display:block; }
.cert-actions .material-symbols-outlined { color: #666; }
.cert-actions .btn { background: transparent; }

/* Certificate dialog typography: values use the same font as public-key bytes */
#certsDialog .cert-label {
  font-family: inherit;
  font-weight: 600;
}

#certsDialog .cert-value {
  font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Monaco, 'Roboto Mono', 'Segoe UI Mono', 'Liberation Mono', monospace;
  font-size: 13px;
  font-weight: 400;
  color: #555;
  word-break: break-word;
  overflow-wrap: anywhere;
  white-space: normal;
}

/* Main certificate fields (Subject/Issuer/Serial/Validity/etc.): keep labels same size as values */
#certsDialog .cert-card .text-sm .cert-label {
  font-size: 13px;
}

/* Extension rows use <small>; don't upsize them via cert-value/cert-label rules */
#certsDialog .cert-card .cert-ext small .cert-label,
#certsDialog .cert-card .cert-ext small .cert-value {
  font-size: inherit;
}

/* Force wrapping for long certificate fields so text doesn't overflow the card */
#certsDialog .cert-card,
#certsDialog .cert-card * {
  box-sizing: border-box;
}

#certsDialog .cert-card small,
#certsDialog .cert-card .fingerprint,
#certsDialog .cert-card .key-usage,
#certsDialog .cert-card .ext-key-usage,
#certsDialog .cert-card .subject-alt-name,
#certsDialog .cert-card dt,
#certsDialog .cert-card dd {
  word-break: break-word !important;
  overflow-wrap: anywhere !important;
  white-space: normal !important;
}

/* Ensure inline icon buttons (copy icon) don't force the fingerprint to stay on one line */
#certsDialog .cert-copy-fingerprint {
  display: inline-flex !important;
  vertical-align: middle !important;
}

/* Make the fingerprint label area allow wrapping while keeping the icon on its own line if space is tight */
#certsDialog .fingerprint-container {
  display: flex;
  flex-direction: row;
  align-items: flex-start;
  gap: 8px;
  flex-wrap: wrap;
}
#certsDialog .fingerprint-text { flex: 1 1 auto; }
#certsDialog .fingerprint-icon { flex: 0 0 auto; }

/* Visual block for public key hex */
.public-key-block {
  margin-top: 8px;
}
.public-key-block .public-key-hex {
  display: block;
  width: 100%;
  /* match the card look: subtle border, transparent background */
  background: transparent;
  border: 1px solid rgba(0,0,0,0.06);
  padding: 8px;
  border-radius: 4px;
  font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
  font-size: 13px;
  color: #555; /* match .cert-card small color */
  white-space: pre-wrap !important;
  word-break: break-word !important;
  overflow-wrap: anywhere !important;
  max-height: 220px;
  overflow: auto;
}
.public-key-block .public-key-hex::selection { background: rgba(26,115,232,0.12); }

/* Collapsible public key block */
.public-key-block .public-key-hex { display: block; }
.public-key-block.collapsed .public-key-hex { display: none; }

/* Hex displays: avoid breaking inside colon-separated byte pairs. Allow horizontal scroll instead. */
.hex-mono {
  white-space: pre !important;
  overflow-x: auto !important;
  word-break: normal !important;
  overflow-wrap: normal !important;
}

/* Plaintext pre blocks (e.g., Client Data JSON) should wrap instead of producing horizontal scrollbars */
.hex-plain-wrap {
  white-space: pre-wrap !important;
  word-break: break-word !important;
  overflow-wrap: anywhere !important;
  overflow-x: hidden !important;
}

/* Stronger rule for hex displays inside registration dialogs to avoid accidental wrapping
   when .mono or .reg-data-list rules try to apply pre-wrap. This ensures the computed
   bytes-per-row can render without being reflowed onto multiple visual lines. */
.app-dialog-content .hex-mono,
.reg-data-list dd .hex-mono {
  white-space: pre !important;
  overflow-x: auto !important;
  word-break: normal !important;
  overflow-wrap: normal !important;
}

/* HexDebug styles removed. */
/* Keep toggle inline with the small label text */
.public-key-toggle, .cert-copy-publickey { display: inline-flex; margin-left: 8px; vertical-align: middle; align-items: center; gap: 6px; line-height: 20px; }
.public-key-toggle { padding: 6px 8px; font-weight: 500; }

/* Match visual style of other action buttons: remove heavy background and use link-like appearance */
.public-key-toggle { background: transparent !important; color: #1a73e8 !important; text-transform: none !important; font-weight: 500 !important; }
.public-key-toggle .material-symbols-outlined { font-size: 18px; }

/* Certificate dialog footer uses an explicit left/right layout */
.app-dialog-actions.cert-dialog-actions { display:flex; flex-direction: row !important; justify-content:space-between; padding:12px 24px 18px 24px; }
.app-dialog-actions.cert-dialog-actions .btn { min-width: 120px; }

/* Force Download Chain on the left and Close on the right */
#certsDownloadChain { order: 0; }
#certsDialog_x { order: 1; margin-left: auto; }

/* Make dialog content tighter */
.app-dialog-content { padding: 12px 16px 0 16px; }

/* Styling for the Decode CBOR button in the creation data dialog */
.openCborButton {
  margin-left: 8px; /* keep spacing but defer visual style to MDL */
}
.openCborButton.btn { min-width: 0; }

/* --------------------------------------------------------------------------
   Tailwind/DaisyUI migration overrides
   -------------------------------------------------------------------------- */

/* Avoid legacy global element rules from fighting DaisyUI */
select,
input[type="text"],
input[type="number"],
textarea {
  font: inherit;
}

/* Toast placement: bottom-center (override DaisyUI toast-end defaults) */
#toast.toast {
  left: 50% !important;
  right: auto !important;
  transform: translateX(-50%);
  align-items: center !important;
  width: auto;
  max-width: min(92vw, 640px);
}

#toast.toast > .alert {
  width: auto;
  max-width: 100%;
}

/* CBOR Playground: keep editor inputs monospace like other value blocks */
.cbor-mono {
  min-height: 180px;
  font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Monaco, 'Roboto Mono', 'Segoe UI Mono', 'Liberation Mono', monospace;
  font-size: 13px;
  color: #555;
}

/* CBOR Playground: constrain line lengths on wide monitors */
.cbor-page .cbor-container {
  width: 100%;
  max-width: 1100px;
  margin: 0 auto;
}

/* CBOR Playground: space between major sections */
.cbor-page .cbor-section {
  margin-top: 16px;
}
.cbor-page .cbor-section + .cbor-section {
  margin-top: 28px;
}

/* Space between cards within a section (e.g., Decode -> Decoded) */
.cbor-page .cbor-section .card + .card {
  margin-top: 18px;
}

/* Ensure our new page layout isn't constrained by old dialog rules */
dialog.modal {
  min-width: 0 !important;
}